import{o as D,y as U,C,A as T,f as G,a as z,E as v,G as R,g as A,J as B,_ as F,r as _,K as N,h as d,i as c,j as l,w as r,k as g,l as V,L as j,t as M,O as q}from"../index75315.js";const E={setup(){D(()=>{u.value=!0,n.value={first:0,rows:w.value.rows,sortField:null,sortOrder:null,filters:a.value},U.register("myfilter",(t,b)=>t===b),p()});const f=C(),s=T(),m=G(()=>f.status),o=G(()=>f.responseGuides),S=z(),w=v(),y=v(),a=v({global:{value:null,matchMode:"like"},full_name:{value:"",matchMode:"like"},email:{value:"",matchMode:"eq"},created_at:{value:"",matchMode:"like"},role:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),u=v(!0),n=v(),x=v(0),k=v([{label:"My Filter",value:"myfilter"}]);function p(){var b;u.value=!0;let t=new Map;(b=a.value.global)!=null&&b.value&&t.set("last_name_like",a.value.global.value),t=R(a,t),t.delete("location_eq"),t.delete("global"),t.set("page",n.value.page+1),t.set("per_page",n.value.rows),n.value.sortField&&(n.value.sortOrder==1?t.set("sorted_by",n.value.sortField+"_asc"):t.set("sorted_by",n.value.sortField+"_desc")),setTimeout(()=>{e(t)},Math.random()*1e3+250)}const e=async function(t){await f.fetchAllGuides(t).then(()=>{u.value=!1}).catch(b=>{u.value=!1,A(S,b)})};return{dt:w,responseGuides:o,filters:a,loading:u,totalRecords:x,lazyParams:n,matchModes:k,currentGuide:y,status:m,onPage:t=>{n.value=t,p()},onSort:t=>{n.value=t,p()},onFilter:()=>{n.value.page=0,n.value.filters=a.value,p()},showSidebar:function(t){s.setDetailType("guide",!1,"Dettaglio guida",t.id),s.updateSidebar(!0)},loadLazyData:p,changeStatus:async function(t){},getRowClass:function(t){return t!=null&&t.cluster?t.cluster:""},formatDataFromUnixTimestamps:B}},components:{}};const K={class:"user-table"},P={class:"flex justify-content-between align-items-center"},L={class:"p-input-icon-left w-full mr-3 py-2"},O=g("i",{class:"pi pi-search"},null,-1),I={key:0},$={key:1},J={key:0},H={key:1},Q={key:0},W={key:1},X={class:"flex justify-content-center"},Y={class:"flex justify-content-center"};function Z(f,s,m,o,S,w){const y=_("InputText"),a=_("Column"),u=_("Avatar"),n=_("Editor"),x=_("Button"),k=_("DataTable"),p=N("tooltip");return d(),c("div",K,[l(k,{value:o.responseGuides.guides,totalRecords:o.responseGuides.total,lazy:!0,paginator:!0,rows:30,filters:o.filters,"onUpdate:filters":s[1]||(s[1]=e=>o.filters=e),ref:"dt",dataKey:"id",loading:o.loading,onPage:s[2]||(s[2]=e=>o.onPage(e)),onSort:s[3]||(s[3]=e=>o.onSort(e)),onFilter:s[4]||(s[4]=e=>o.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:"",rowClass:o.getRowClass},{header:r(()=>[g("div",P,[g("span",L,[O,l(y,{modelValue:o.filters.global.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.filters.global.value=e),placeholder:"Ricerca per cognome",class:"border-none w-full",onChange:o.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:r(()=>[V(" Nessuna guida trovata. ")]),default:r(()=>[l(a,{field:"full_name",header:"Nome Cognome",filterMatchMode:"contains",ref:"full_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:r(({filterModel:e,filterCallback:i})=>[l(y,{type:"text",modelValue:e.value,"onUpdate:modelValue":h=>e.value=h,onKeydown:j(h=>i(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:r(({data:e})=>[V(M(e==null?void 0:e.full_name),1)]),_:1},512),l(a,{header:"Foto",filterMatchMode:"contains",ref:"location",field:"location"},{body:r(({data:e})=>{var i;return[e.image_url?(d(),c("div",I,[l(u,{image:(i=e.image_url)==null?void 0:i.url,class:"mr-2",size:"xlarge",shape:"circle"},null,8,["image"])])):(d(),c("div",$,"-"))]}),_:1},512),l(a,{header:"Descrizione breve (IT)",filterMatchMode:"contains",ref:"location",field:"location",style:{width:"30rem"}},{body:r(({data:e})=>{var i;return[e.translations&&((i=e.translations.it.short_description)!=null&&i.text)?(d(),c("div",J,[l(n,{modelValue:e.translations.it.short_description.text,"onUpdate:modelValue":h=>e.translations.it.short_description.text=h,readonly:!0},null,8,["modelValue","onUpdate:modelValue"])])):(d(),c("span",H,"-"))]}),_:1},512),l(a,{header:"Descrizione breve (EN)",filterMatchMode:"contains",ref:"location",field:"location",style:{width:"30rem"}},{body:r(({data:e})=>{var i;return[e.translations&&((i=e.translations.en.short_description)!=null&&i.text)?(d(),c("div",Q,[l(n,{modelValue:e.translations.en.short_description.text,"onUpdate:modelValue":h=>e.translations.en.short_description.text=h,readonly:!0},null,8,["modelValue","onUpdate:modelValue"])])):(d(),c("span",W,"-"))]}),_:1},512),l(a,{header:"Lingue parlate",filterMatchMode:"contains",ref:"known_languages",field:"known_languages"},{body:r(({data:e})=>[g("div",X,M(e.known_languages||"-"),1)]),_:1},512),l(a,{header:"Anni di esperienza",filterMatchMode:"contains",ref:"years",field:"years",headerClass:"flex justify-content-center"},{body:r(({data:e})=>[g("div",Y,M(e.years||"-"),1)]),_:1},512),l(a,{header:"",style:{width:"4rem"}},{body:r(({data:e})=>[q(l(x,{type:"button",onClick:i=>o.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[p,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const ee=F(E,[["render",Z]]),te={setup(){const f=C(),s=G(()=>f.getTotalGuides),m=T();return{totalGuides:s,showSidebar:function(){m.setDetailType("guide",!0,"Nuova guida",null),m.updateSidebar(!0),m.setShowDetail(!0)}}},components:{GuidesTable:ee}},oe={class:"flex justify-content-between align-items-center"},se={class:""},ae={key:0},le={key:1};function ne(f,s,m,o,S,w){const y=_("Button"),a=_("GuidesTable");return d(),c("div",null,[g("div",oe,[g("h1",se,[o.totalGuides==1?(d(),c("span",ae," 1 Guida")):(d(),c("span",le,M(o.totalGuides)+" Guide",1))]),l(y,{label:"Aggiungi guida",onClick:s[0]||(s[0]=u=>o.showSidebar()),class:"mb-3",rounded:"",outlined:""})]),l(a)])}const _e=F(te,[["render",ne]]);export{_e as default};
