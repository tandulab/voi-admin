import{o as U,y as z,z as x,A as D,f as C,a as B,B as h,C as R,g as K,D as N,_ as k,r as f,E as P,h as w,i as T,j as n,w as s,k as v,l as g,G as V,t as c,H as j}from"../index53817.js";const q={setup(){U(()=>{d.value=!0,r.value={first:0,rows:M.value.rows,sortField:null,sortOrder:null,filters:l.value},z.register("myfilter",(o,y)=>o===y),_()});const p=x(),a=D(),m=C(()=>p.status),t=C(()=>p.responseAudioTour),S=B(),M=h(),b=h(),l=h({global:{value:null,matchMode:"like"},name:{value:"",matchMode:"like"},email:{value:"",matchMode:"eq"},created_at:{value:"",matchMode:"like"},role:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),d=h(!0),r=h(),A=h(0),F=h([{label:"My Filter",value:"myfilter"}]);function _(){var y;d.value=!0;let o=new Map;(y=l.value.global)!=null&&y.value&&o.set("name_like",l.value.global.value),o=R(l,o),o.delete("location_eq"),o.delete("global"),o.set("page",r.value.page+1),o.set("per_page",r.value.rows),r.value.sortField&&(r.value.sortOrder==1?o.set("sorted_by",r.value.sortField+"_asc"):o.set("sorted_by",r.value.sortField+"_desc")),setTimeout(()=>{e(o)},Math.random()*1e3+250)}const e=async function(o){await p.fetchAllAudioTours(o).then(()=>{d.value=!1}).catch(y=>{d.value=!1,K(S,y)})};return{dt:M,responseAudioTours:t,filters:l,loading:d,totalRecords:A,lazyParams:r,matchModes:F,currentAudioTour:b,status:m,onPage:o=>{r.value=o,_()},onSort:o=>{r.value=o,_()},onFilter:()=>{r.value.page=0,r.value.filters=l.value,_()},showSidebar:function(o){a.setDetailType("audio_tour",!1,"Dettaglio audio itinerario",o.id),a.updateSidebar(!0)},loadLazyData:_,changeStatus:async function(o){},getRowClass:function(o){return o!=null&&o.cluster?o.cluster:""},formatDataFromUnixTimestamps:N}},components:{}};const L={class:"user-table"},O={class:"flex justify-content-between align-items-center"},I={class:"p-input-icon-left w-full mr-3 py-2"},$=v("i",{class:"pi pi-search"},null,-1),E={key:0},G={key:1},H=v("div",{class:"flex justify-content-center w-full"},"Durata (min)",-1),J={class:"flex justify-content-center"};function Q(p,a,m,t,S,M){const b=f("InputText"),l=f("Column"),d=f("Calendar"),r=f("Dropdown"),A=f("Button"),F=f("DataTable"),_=P("tooltip");return w(),T("div",L,[n(F,{value:t.responseAudioTours.users,totalRecords:t.responseAudioTours.total,lazy:!0,paginator:!0,rows:30,filters:t.filters,"onUpdate:filters":a[1]||(a[1]=e=>t.filters=e),ref:"dt",dataKey:"id",loading:t.loading,onPage:a[2]||(a[2]=e=>t.onPage(e)),onSort:a[3]||(a[3]=e=>t.onSort(e)),onFilter:a[4]||(a[4]=e=>t.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:"",rowClass:t.getRowClass},{header:s(()=>[v("div",O,[v("span",I,[$,n(b,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.filters.global.value=e),placeholder:"Ricerca per nome",class:"border-none w-full",onChange:t.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:s(()=>[g(" Nessun utente trovato. ")]),default:s(()=>[n(l,{field:"name",header:"Nome",filterMatchMode:"contains",ref:"name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:s(({filterModel:e,filterCallback:u})=>[n(b,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,onKeydown:V(i=>u(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:s(({data:e})=>[g(c(e==null?void 0:e.name),1)]),_:1},512),n(l,{header:"Location",filterMatchMode:"contains",ref:"location",field:"location"},{body:s(({data:e})=>[g(c(e.location||"-"),1)]),_:1},512),n(l,{header:"Lingue",filterMatchMode:"contains",ref:"location",field:"location"},{body:s(({data:e})=>[g(c(e.languages||"-"),1)]),_:1},512),n(l,{header:"Data creazione",field:"created_at",filterMatchMode:"contains",ref:"created_at",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:s(({filterModel:e,filterCallback:u})=>[n(d,{inputId:"dateformat",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,dateFormat:"dd/mm/yy",onKeydown:V(i=>u(),["enter"]),manualInput:!1,placeholder:"Filtra per data",onDateSelect:i=>u()},null,8,["modelValue","onUpdate:modelValue","onKeydown","onDateSelect"])]),body:s(({data:e})=>[g(c(t.formatDataFromUnixTimestamps(e==null?void 0:e.created_at)),1)]),_:1},512),n(l,{header:"Prezzo",ref:"price",field:"price"},{body:s(({data:e})=>[e.price?(w(),T("span",E,c(e.price)+"â‚¬",1)):(w(),T("span",G,"-"))]),_:1},512),n(l,{header:"",filterMatchMode:"contains",ref:"location",field:"location"},{header:s(()=>[H]),body:s(({data:e})=>[v("div",J,c(e.duration||"-"),1)]),_:1},512),n(l,{header:"Stato",filterMatchMode:"contains",ref:"enabled",field:"enabled",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:s(({filterModel:e,filterCallback:u})=>[n(r,{modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,options:t.status,optionLabel:"name",optionValue:"value",onChange:i=>u(),placeholder:"Filtra per stato"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:s(({data:e})=>[g(c(e.enabled?"Attivo":"Disattivo"),1)]),_:1},512),n(l,{header:"",style:{width:"4rem"}},{body:s(({data:e})=>[j(n(A,{type:"button",onClick:u=>t.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[_,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const W=k(q,[["render",Q]]),X={setup(){const p=x(),a=C(()=>p.getTotalAudioTour),m=D();return{totalAudioTour:a,showSidebar:function(){m.setDetailType("user",!0,"Nuovo utente",null),m.updateSidebar(!0),m.setShowDetail(!0)}}},components:{AudioTourTable:W}},Y={class:"flex justify-content-between align-items-center"},Z={class:""},ee={key:0},oe={key:1};function te(p,a,m,t,S,M){const b=f("Button"),l=f("AudioTourTable");return w(),T("div",null,[v("div",Y,[v("h1",Z,[t.totalAudioTour==1?(w(),T("span",ee," 1 Audio itinerario")):(w(),T("span",oe,c(t.totalAudioTour)+" Audio itinerari",1))]),n(b,{label:"Aggiungi audio itinerario",onClick:a[0]||(a[0]=d=>t.showSidebar()),class:"mb-3",rounded:"",outlined:""})]),n(l)])}const ie=k(X,[["render",te]]);export{ie as default};
