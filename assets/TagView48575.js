import{o as Y,M as I,A as Z,f as D,N as tt,a as et,B as i,b as at,g as k,p as nt,D as ot,O as st,s as C,P as lt,_ as K,r as T,E as it,h as p,i as _,j as r,w as u,Q as B,R as rt,k as V,l as ct,G as j,t as U,H as dt,S as ut}from"../index48575.js";const mt={setup(){Y(()=>{h.value=!0,b()});const c=I(),d=Z(),v=D(()=>c.status),n=tt(),m=D(()=>c.responseTags),S=D(()=>n.submitDialog),o=et(),f=i(),R=i(),w=i([]),E=i(),t=i([]),a=i(),{showLoader:g,hideLoader:y}=at(),$=i({global:{value:null,matchMode:"like"},name:{value:"",matchMode:"like"}}),h=i(!0),A=i(),L=i(0),O=i([{label:"My Filter",value:"myfilter"}]),b=async function(){h.value=!0,await c.fetchAllTags().then(()=>{h.value=!1,z()}).catch(e=>{h.value=!1,k(o,e)})},z=function(){t.value=m.value.tags,F()},H=function(e){d.setDetailType("tag",!1,"Dettaglio tag",e.id),d.updateSidebar(!0)},P=async function(e){g();const s={formData:G(e)};await c.createTag(s).then(()=>{C(o,{message:"Il tag è stato creato correttamente",error:!1}),b(),y()}).catch(l=>{y(),k(o,l)})},G=function(e){const s=new FormData,l=Object.assign({},e);return l.translations.it.name=e.translations.it.name.text,l.translations.en.name=e.translations.en.name.text,lt(s,l,"tag"),s},Q=e=>{e.data.id=="-1"?(F(),P(e.data)):q(e.data)},q=function(e){st(e,e).then(()=>{C(o,{message:"Tag aggiornato correttamente",error:!1})})},J=e=>{var s;if(e.data.id=="-1")e.data.translations.it.name.text="",e.data.translations.en.name.text="";else if((s=m==null?void 0:m.value)!=null&&s.tags){const l=m.value.tags.find(x=>x.id===e.data.id);l&&(e.data.translations.it.name.text=l.translations.it.name.text,e.data.translations.en.name.text=l.translations.en.name.text)}},F=function(){if(t.value){let e={id:"-1",translations:{it:{name:{text:""}},en:{name:{text:""}}}};t.value.unshift(e),w.value.push(e)}},W=function(e,s){var x,M,N;a.value=s.data.id;let l="Sei sicuro di voler eliminare il tag";(N=(M=(x=s==null?void 0:s.data)==null?void 0:x.translations.it)==null?void 0:M.name)!=null&&N.text&&(l+="<b> "+s.data.translations.it.name.text+"</b>"),l+=" ?",n.setDialog("Elimina tag","Elimina tag","Annulla",l),n.setDynamicDialogVisibility(!0)},X=function(){g(),a.value&&c.deleteTag(a.value).then(()=>{y(),C(o,{message:"Il tag è stato eliminato",error:!1}),b()}).catch(e=>{y(),k(o,e)})};return nt(S,e=>{X()}),{dt:f,responseTags:m,filters:$,loading:h,totalRecords:L,lazyParams:A,matchModes:O,currentTag:R,status:v,editingRows:w,tmp_val:E,tmp_tags:t,showSidebar:H,fetchAllTags:b,onRowEditSave:Q,onRowEditCancel:J,confirmDeleteTag:W,formatDataFromUnixTimestamps:ot}},components:{}};const gt=V("div",{class:"flex w-full"},null,-1),pt={key:0,class:"tag-table col-8"},_t={key:0},ft={key:1},ht={key:0},Tt={key:1};function vt(c,d,v,n,m,S){const o=T("InputText"),f=T("Column"),R=T("Button"),w=T("DataTable"),E=it("tooltip");return p(),_(rt,null,[gt,n.tmp_tags?(p(),_("div",pt,[r(w,{value:n.tmp_tags,lazy:!0,ref:"dt",loading:n.loading,stripedRows:"",editingRows:n.editingRows,"onUpdate:editingRows":d[0]||(d[0]=t=>n.editingRows=t),editMode:"row",onRowEditSave:n.onRowEditSave,onRowEditCancel:n.onRowEditCancel},{empty:u(()=>[ct(" Nessun tag trovato. ")]),default:u(()=>[r(f,{field:"name",header:"Nome IT",filterMatchMode:"contains",ref:"name_it"},{filter:u(({filterModel:t,filterCallback:a})=>[r(o,{type:"text",modelValue:t.value,"onUpdate:modelValue":g=>t.value=g,onKeydown:j(g=>a(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:u(({data:t})=>{var a;return[t.translations.it?(p(),_("span",_t,U((a=t==null?void 0:t.translations.it.name)==null?void 0:a.text),1)):(p(),_("span",ft,"-"))]}),editor:u(({data:t})=>[r(o,{modelValue:t.translations.it.name.text,"onUpdate:modelValue":a=>t.translations.it.name.text=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1},512),r(f,{field:"name_en",header:"Nome EN",filterMatchMode:"contains",ref:"name_en"},{filter:u(({filterModel:t,filterCallback:a})=>[r(o,{type:"text",modelValue:t.value,"onUpdate:modelValue":g=>t.value=g,onKeydown:j(g=>a(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:u(({data:t})=>{var a;return[t.translations.en?(p(),_("span",ht,U((a=t==null?void 0:t.translations.en.name)==null?void 0:a.text),1)):(p(),_("span",Tt,"-"))]}),editor:u(({data:t})=>[r(o,{modelValue:t.translations.en.name.text,"onUpdate:modelValue":a=>t.translations.en.name.text=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1},512),r(f,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"}),r(f,null,{body:u(t=>[t.index!=0?dt((p(),ut(R,{key:0,type:"button",onClick:a=>n.confirmDeleteTag(a,t),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-400",icon:"pi pi-trash"},null,8,["onClick"])),[[E,"Elimina",void 0,{top:!0}]]):B("",!0)]),_:1})]),_:1},8,["value","loading","editingRows","onRowEditSave","onRowEditCancel"])])):B("",!0)],64)}const wt=K(mt,[["render",vt]]),yt={setup(){const c=I(),d=i();return{totalTags:D(()=>c.getTotalTags),tagsTable:d,showSidebar:function(){d.value.addTag()}}},components:{TagsTable:wt}},bt={class:"flex justify-content-between align-items-center"},xt={class:""};function Dt(c,d,v,n,m,S){const o=T("TagsTable");return p(),_("div",null,[V("div",bt,[V("h1",xt,[V("span",null,U(n.totalTags)+" Tag",1)])]),r(o,{ref:"tagsTable"},null,512)])}const St=K(yt,[["render",Dt]]);export{St as default};
