import{o as P,y as j,z as U,A as D,B as K,C as E,D as I,f as w,a as H,E as v,G as J,g as F,H as $,J as Q,_ as B,r as _,K as W,h as r,i as d,j as s,w as n,k as c,l as S,L as X,t as f,M as k,N as T,q as Y,O as Z}from"../index79469.js";const ee={setup(){P(()=>{o.value=!0,t.value={first:0,rows:A.value.rows,sortField:null,sortOrder:null,filters:e.value},j.register("myfilter",(a,p)=>a===p),M(),R(),N(),q()});const g=U(),i=D(),h=K(),l=E(),C=I(),V=w(()=>g.status),y=w(()=>g.responseAudioGuide),u=w(()=>h.responseCategories),m=w(()=>l.allGuides),x=w(()=>C.allTags),b=H(),A=v(),G=v(),e=v({global:{value:null,matchMode:"like"},name:{value:"",matchMode:"like"},category:{value:"",matchMode:"eq"},created_at:{value:"",matchMode:"like"},tag:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},guide:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),o=v(!0),t=v(),L=v(0),z=v([{label:"My Filter",value:"myfilter"}]);function M(){var p;o.value=!0;let a=new Map;(p=e.value.global)!=null&&p.value&&a.set("name_like",e.value.global.value),a=J(e,a),a.delete("location_eq"),a.delete("global"),a.set("page",t.value.page+1),a.set("per_page",t.value.rows),t.value.sortField&&(t.value.sortOrder==1?a.set("sorted_by",t.value.sortField+"_asc"):a.set("sorted_by",t.value.sortField+"_desc")),setTimeout(()=>{O(a)},Math.random()*1e3+250)}const O=async function(a){await g.fetchAllAudioGuides(a).then(()=>{o.value=!1}).catch(p=>{o.value=!1,F(b,p)})},R=async function(){let a=new Map;await h.fetchAllCategories(a).then(()=>{o.value=!1}).catch(p=>{o.value=!1,F(b,p)})},q=async function(){let a=new Map;await l.fetchAllGuides(a).then(()=>{o.value=!1}).catch(p=>{o.value=!1,F(b,p)})},N=async function(){await C.fetchAllTags().then(()=>{o.value=!1}).catch(a=>{o.value=!1,F(b,a)})};return{dt:A,responseAudioGuides:y,filters:e,loading:o,totalRecords:L,lazyParams:t,matchModes:z,currentAudioGuide:G,status:V,categories:u,guides:m,tags:x,onPage:a=>{t.value=a,M()},onSort:a=>{t.value=a,M()},onFilter:()=>{t.value.page=0,t.value.filters=e.value,M()},showSidebar:function(a){i.setDetailType("audio_tour",!1,"Dettaglio audio itinerario",a.id),i.updateSidebar(!0)},loadLazyData:M,changeStatus:async function(a){},getRowClass:function(a){return a!=null&&a.cluster?a.cluster:""},prettyCategoryGroup:$,formatDataFromUnixTimestamps:Q}},components:{}};const oe={class:"user-table"},te={class:"flex justify-content-between align-items-center"},ae={class:"p-input-icon-left w-full mr-3 py-2"},le=c("i",{class:"pi pi-search"},null,-1),se={class:"flex align-items-center"},ne={class:"flex flex-column line-height-3"},ie={class:"flex flex-column line-height-3"},re={class:"flex flex-column line-height-3"},de={key:0,class:"text-right"},ue={key:0},ce={key:1,class:"flex flex-column"},fe={class:"line-through"},pe={key:1},he=c("div",{class:"flex justify-content-center w-full"},"Durata",-1),_e={class:"flex justify-content-center"},ge={key:0},me={key:1};function ve(g,i,h,l,C,V){const y=_("InputText"),u=_("Column"),m=_("Dropdown"),x=_("Badge"),b=_("Button"),A=_("DataTable"),G=W("tooltip");return r(),d("div",oe,[s(A,{value:l.responseAudioGuides.audio_guides,totalRecords:l.responseAudioGuides.total,lazy:!0,paginator:!0,rows:30,filters:l.filters,"onUpdate:filters":i[1]||(i[1]=e=>l.filters=e),ref:"dt",dataKey:"id",loading:l.loading,onPage:i[2]||(i[2]=e=>l.onPage(e)),onSort:i[3]||(i[3]=e=>l.onSort(e)),onFilter:i[4]||(i[4]=e=>l.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:"",rowClass:l.getRowClass},{header:n(()=>[c("div",te,[c("span",ae,[le,s(y,{modelValue:l.filters.global.value,"onUpdate:modelValue":i[0]||(i[0]=e=>l.filters.global.value=e),placeholder:"Ricerca per nome",class:"border-none w-full",onChange:l.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:n(()=>[S(" Nessun utente trovato. ")]),default:n(()=>[s(u,{field:"name",header:"Nome",filterMatchMode:"contains",ref:"name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:o})=>[s(y,{type:"text",modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,onKeydown:X(t=>o(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:n(({data:e})=>{var o,t;return[S(f(((t=(o=e==null?void 0:e.translations.it)==null?void 0:o.title)==null?void 0:t.text)||"-"),1)]}),_:1},512),s(u,{header:"Location",filterMatchMode:"contains",ref:"location",field:"location"},{body:n(({data:e})=>[S(f(e.location||"-"),1)]),_:1},512),s(u,{header:"Categoria",ref:"category",field:"category",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:o})=>[s(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,options:l.categories,optionLabel:"flat_translations.it",optionGroupLabel:"group",optionGroupChildren:"items",placeholder:"Filtra per categoria",class:"w-full",onChange:t=>o()},{optiongroup:n(t=>[c("div",se,[c("div",null,f(l.prettyCategoryGroup(t.option.group)),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange"])]),body:n(({data:e})=>[c("div",ne,[(r(!0),d(k,null,T(e.categories,o=>(r(),d("span",{key:o.id},f(o.flat_translations.it),1))),128))])]),_:1},512),s(u,{header:"Tag",ref:"tag",field:"tag",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:o})=>[s(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,options:l.tags,optionLabel:"flat_translations.it",optionValue:"id",onChange:t=>o(),placeholder:"Filtra per tag"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:n(({data:e})=>[c("div",ie,[(r(!0),d(k,null,T(e.tags,o=>(r(),d("span",{key:o.id},f(o.flat_translations.it),1))),128))])]),_:1},512),s(u,{header:"Lingue",filterMatchMode:"contains",ref:"location",field:"location"},{body:n(({data:e})=>[c("div",re,[(r(!0),d(k,null,T(e.languages,o=>(r(),d("span",{key:o.id},f(o.language),1))),128))])]),_:1},512),s(u,{header:"Prezzo",ref:"price",field:"price"},{body:n(({data:e})=>[e.price?(r(),d("div",de,[e.discounted_price?(r(),d("div",ce,[c("span",fe,"€ "+f(e.price/100),1),c("b",null,"€ "+f(e.discounted_price/100),1)])):(r(),d("span",ue,"€ "+f(e.price/100),1))])):(r(),d("span",pe,"-"))]),_:1},512),s(u,{header:"",filterMatchMode:"contains",ref:"location",field:"location"},{header:n(()=>[he]),body:n(({data:e})=>[c("div",_e,[e.duration?(r(),d("span",ge,f(e.duration)+" min",1)):(r(),d("span",me,"-"))])]),_:1},512),s(u,{header:"Guida",ref:"guide",field:"guide",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:o})=>[s(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,options:l.guides,optionLabel:"full_name",optionValue:"id",onChange:t=>o(),placeholder:"Filtra per guida"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:n(({data:e})=>{var o;return[S(f(((o=e.guide)==null?void 0:o.full_name)||"-"),1)]}),_:1},512),s(u,{header:"Stato",filterMatchMode:"contains",ref:"enabled",field:"enabled",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:o})=>[s(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,options:l.status,optionLabel:"name",optionValue:"value",onChange:t=>o(),placeholder:"Filtra per stato"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:n(({data:e})=>[s(x,{value:"Bozza",class:Y(["px-4 border-round-lg h-auto font-medium line-height-4","draft"])})]),_:1},512),s(u,{header:"",style:{width:"4rem"}},{body:n(({data:e})=>[Z(s(b,{type:"button",onClick:o=>l.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[G,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const ye=B(ee,[["render",ve]]),be={setup(){const g=U(),i=w(()=>g.getTotalAudioGuide),h=D();return{totalAudioGuide:i,showSidebar:function(){h.setDetailType("audio_tour",!0,"Nuovo audio itinerario",null),h.updateSidebar(!0),h.setShowDetail(!0)}}},components:{AudioGuideTable:ye}},we={class:"flex justify-content-between align-items-center"},Me={class:""},Ce={key:0},Ae={key:1};function Fe(g,i,h,l,C,V){const y=_("Button"),u=_("AudioGuideTable");return r(),d("div",null,[c("div",we,[c("h1",Me,[l.totalAudioGuide==1?(r(),d("span",Ce," 1 Audio itinerario")):(r(),d("span",Ae,f(l.totalAudioGuide)+" Audio itinerari",1))]),s(y,{label:"Aggiungi",onClick:i[0]||(i[0]=m=>l.showSidebar()),class:"mb-3",rounded:"",outlined:""})]),s(u)])}const De=B(be,[["render",Fe]]);export{De as default};
