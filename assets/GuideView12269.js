import{o as F,E as D,B as V,G as C,f as k,a as U,y as v,J as z,g as B,L as R,_ as T,r as _,M as N,h as d,i as c,j as l,w as r,k as g,l as j,U as A,t as G,Q as q}from"../index12269.js";const E={setup(){F(()=>{u.value=!0,n.value={first:0,rows:w.value.rows,sortField:null,sortOrder:null,filters:s.value},D.register("myfilter",(t,b)=>t===b),p()});const f=V(),a=C(),m=k(()=>f.status),o=k(()=>f.responseGuides),M=U(),w=v(),y=v(),s=v({global:{value:null,matchMode:"like"},full_name:{value:"",matchMode:"like"},email:{value:"",matchMode:"eq"},created_at:{value:"",matchMode:"like"},role:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),u=v(!0),n=v(),S=v(0),x=v([{label:"My Filter",value:"myfilter"}]);function p(){var b;u.value=!0;let t=new Map;(b=s.value.global)!=null&&b.value&&t.set("last_name_like",s.value.global.value),t=z(s,t),t.delete("location_eq"),t.delete("global"),t.set("page",n.value.page+1),t.set("per_page",n.value.rows),n.value.sortField&&(n.value.sortOrder==1?t.set("sorted_by",n.value.sortField+"_asc"):t.set("sorted_by",n.value.sortField+"_desc")),setTimeout(()=>{e(t)},Math.random()*1e3+250)}const e=async function(t){await f.fetchAllGuides(t).then(()=>{u.value=!1}).catch(b=>{u.value=!1,B(M,b)})};return{dt:w,responseGuides:o,filters:s,loading:u,totalRecords:S,lazyParams:n,matchModes:x,currentGuide:y,status:m,onPage:t=>{n.value=t,p()},onSort:t=>{n.value=t,p()},onFilter:()=>{n.value.page=0,n.value.filters=s.value,p()},showSidebar:function(t){a.setDetailType("guide",!1,"Dettaglio guida",t.id),a.updateSidebar(!0)},loadLazyData:p,changeStatus:async function(t){},getRowClass:function(t){return t!=null&&t.cluster?t.cluster:""},formatDataFromUnixTimestamps:R}},components:{}};const P={class:"user-table"},K={class:"flex justify-content-between align-items-center"},L={class:"p-input-icon-left w-full mr-3 py-2"},I=g("i",{class:"pi pi-search"},null,-1),O={key:0},$={key:1},J={key:0},Q={key:1},H={key:0},W={key:1},X={class:"flex justify-content-center"},Y={class:"flex justify-content-center"};function Z(f,a,m,o,M,w){const y=_("InputText"),s=_("Column"),u=_("Avatar"),n=_("Editor"),S=_("Button"),x=_("DataTable"),p=N("tooltip");return d(),c("div",P,[l(x,{value:o.responseGuides.guides,totalRecords:o.responseGuides.total,lazy:!0,paginator:!0,rows:30,filters:o.filters,"onUpdate:filters":a[1]||(a[1]=e=>o.filters=e),ref:"dt",dataKey:"id",loading:o.loading,onPage:a[2]||(a[2]=e=>o.onPage(e)),onSort:a[3]||(a[3]=e=>o.onSort(e)),onFilter:a[4]||(a[4]=e=>o.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:"",rowClass:o.getRowClass},{header:r(()=>[g("div",K,[g("span",L,[I,l(y,{modelValue:o.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filters.global.value=e),placeholder:"Ricerca per cognome",class:"border-none w-full",onChange:o.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:r(()=>[j(" Nessuna guida trovata. ")]),default:r(()=>[l(s,{field:"full_name",header:"Nome Cognome",filterMatchMode:"contains",ref:"full_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:r(({filterModel:e,filterCallback:i})=>[l(y,{type:"text",modelValue:e.value,"onUpdate:modelValue":h=>e.value=h,onKeydown:A(h=>i(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),l(s,{header:"Foto",filterMatchMode:"contains",ref:"location",field:"location"},{body:r(({data:e})=>{var i;return[e.image_url?(d(),c("div",O,[l(u,{image:(i=e.image_url)==null?void 0:i.url,class:"mr-2",size:"xlarge",shape:"circle"},null,8,["image"])])):(d(),c("div",$,"-"))]}),_:1},512),l(s,{header:"Descrizione breve (IT)",filterMatchMode:"contains",ref:"location",field:"location",style:{width:"30rem"}},{body:r(({data:e})=>{var i;return[e.translations&&((i=e.translations.it.short_description)!=null&&i.text)?(d(),c("div",J,[l(n,{modelValue:e.translations.it.short_description.text,"onUpdate:modelValue":h=>e.translations.it.short_description.text=h,readonly:!0},null,8,["modelValue","onUpdate:modelValue"])])):(d(),c("span",Q,"-"))]}),_:1},512),l(s,{header:"Descrizione breve (EN)",filterMatchMode:"contains",ref:"location",field:"location",style:{width:"30rem"}},{body:r(({data:e})=>{var i;return[e.translations&&((i=e.translations.en.short_description)!=null&&i.text)?(d(),c("div",H,[l(n,{modelValue:e.translations.en.short_description.text,"onUpdate:modelValue":h=>e.translations.en.short_description.text=h,readonly:!0},null,8,["modelValue","onUpdate:modelValue"])])):(d(),c("span",W,"-"))]}),_:1},512),l(s,{header:"Lingue parlate",filterMatchMode:"contains",ref:"known_languages",field:"known_languages"},{body:r(({data:e})=>[g("div",X,G(e.known_languages||"-"),1)]),_:1},512),l(s,{header:"Anni di esperienza",filterMatchMode:"contains",ref:"years",field:"years",headerClass:"flex justify-content-center"},{body:r(({data:e})=>[g("div",Y,G(e.years||"-"),1)]),_:1},512),l(s,{header:"",style:{width:"4rem"}},{body:r(({data:e})=>[q(l(S,{type:"button",onClick:i=>o.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[p,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const ee=T(E,[["render",Z]]),te={setup(){const f=V(),a=k(()=>f.getTotalGuides),m=C();return{totalGuides:a,showSidebar:function(){m.setDetailType("guide",!0,"Nuova guida",null),m.updateSidebar(!0),m.setShowDetail(!0)}}},components:{GuidesTable:ee}},oe={class:"flex justify-content-between align-items-center"},ae={class:""},se={key:0},le={key:1};function ne(f,a,m,o,M,w){const y=_("Button"),s=_("GuidesTable");return d(),c("div",null,[g("div",oe,[g("h1",ae,[o.totalGuides==1?(d(),c("span",se," 1 Guida")):(d(),c("span",le,G(o.totalGuides)+" Guide",1))]),l(y,{label:"Aggiungi guida",onClick:a[0]||(a[0]=u=>o.showSidebar()),class:"mb-3",rounded:"",outlined:""})]),l(s)])}const _e=T(te,[["render",ne]]);export{_e as default};
