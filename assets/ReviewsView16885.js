import{o as N,E as z,V as D,G as U,f as k,a as B,y as f,J as O,g as P,L as q,_ as K,r as d,M as I,h as b,i as y,j as s,w as c,k as u,l as x,U as C,t as g,Q as T}from"../index16885.js";const L={setup(){N(()=>{v.value=!0,r.value={first:0,rows:R.value.rows,sortField:null,sortOrder:null,filters:n.value},z.register("myfilter",(t,w)=>t===w),_()});const p=D(),a=U(),m=k(()=>p.status),o=k(()=>p.responseReviews),V=B(),R=f(),h=f(),n=f({global:{value:null,matchMode:"like"},name:{value:"",matchMode:"like"},users_email_like:{value:"",matchMode:"link"},created_at:{value:"",matchMode:"like"},role:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),v=f(!0),r=f(),F=f(0),M=f([{label:"My Filter",value:"myfilter"}]);function _(){var w;v.value=!0;let t=new Map;(w=n.value.global)!=null&&w.value&&t.set("users_email_like",n.value.global.value),t=O(n,t),t.delete("location_eq"),t.delete("global_like"),t.set("page",r.value.page+1),t.set("per_page",r.value.rows),r.value.sortField&&(r.value.sortOrder==1?t.set("sorted_by",r.value.sortField+"_asc"):t.set("sorted_by",r.value.sortField+"_desc")),setTimeout(()=>{S(t)},Math.random()*1e3+250)}const S=async function(t){await p.fetchAllReviews(t).then(()=>{v.value=!1}).catch(w=>{v.value=!1,P(V,w)})};return{dt:R,responseReviews:o,filters:n,loading:v,totalRecords:F,lazyParams:r,matchModes:M,currentReview:h,status:m,onPage:t=>{r.value=t,_()},onSort:t=>{r.value=t,_()},onFilter:()=>{r.value.page=0,r.value.filters=n.value,_()},showSidebar:function(t){a.setDetailType("review",!1,"Dettaglio recensione",t.id),a.updateSidebar(!0)},loadLazyData:_,changeStatus:async function(t){},getRowClass:function(t){return t!=null&&t.cluster?t.cluster:""},formatDataFromUnixTimestamps:q}},components:{}};const j={class:"user-table"},A={class:"flex justify-content-between align-items-center"},E={class:"p-input-icon-left w-full mr-3 py-2"},$=u("i",{class:"pi pi-search"},null,-1),G=u("div",{class:"text-center w-full"},"Stato",-1),J={class:"text-center"},Q={key:0,class:"pi pi-check-circle text-green-500 text-xl"},H={key:1,class:"pi pi-times-circle text-red-500 text-xl"},W={class:"flex align-items-center"};function X(p,a,m,o,V,R){const h=d("InputText"),n=d("Column"),v=d("Calendar"),r=d("Rating"),F=d("Dropdown"),M=d("Button"),_=d("DataTable"),S=I("tooltip");return b(),y("div",j,[s(_,{value:o.responseReviews.reviews,totalRecords:o.responseReviews.total,lazy:!0,paginator:!0,rows:30,filters:o.filters,"onUpdate:filters":a[1]||(a[1]=e=>o.filters=e),ref:"dt",dataKey:"id",loading:o.loading,onPage:a[2]||(a[2]=e=>o.onPage(e)),onSort:a[3]||(a[3]=e=>o.onSort(e)),onFilter:a[4]||(a[4]=e=>o.onFilter()),removableSort:"",stripedRows:"",rowClass:o.getRowClass},{header:c(()=>[u("div",A,[u("span",E,[$,s(h,{modelValue:o.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filters.global.value=e),placeholder:"Ricerca per email",class:"border-none w-full",onChange:o.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:c(()=>[x(" Nessuna recensione trovata. ")]),default:c(()=>[s(n,{field:"name",header:"Nome Cognome",filterMatchMode:"contains",ref:"name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:c(({filterModel:e,filterCallback:l})=>[s(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,onKeydown:C(i=>l(),["enter"]),class:"p-column-filter",placeholder:"Filtra per cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:c(({data:e})=>{var l,i;return[x(g((l=e==null?void 0:e.user)==null?void 0:l.first_name)+" "+g((i=e==null?void 0:e.user)==null?void 0:i.last_name),1)]}),_:1},512),s(n,{field:"users_email_like",header:"Email",filterMatchMode:"contains",ref:"email"},{body:c(({data:e})=>{var l;return[x(g(((l=e==null?void 0:e.user)==null?void 0:l.email)||"-"),1)]}),_:1},512),s(n,{header:"Data creazione",field:"created_at",filterMatchMode:"contains",ref:"created_at",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:c(({filterModel:e,filterCallback:l})=>[s(v,{inputId:"dateformat",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,dateFormat:"dd/mm/yy",onKeydown:C(i=>l(),["enter"]),manualInput:!1,placeholder:"Filtra per data",onDateSelect:i=>l()},null,8,["modelValue","onUpdate:modelValue","onKeydown","onDateSelect"])]),body:c(({data:e})=>[x(g(o.formatDataFromUnixTimestamps(e==null?void 0:e.created_at)),1)]),_:1},512),s(n,{header:"Testo",filterMatchMode:"contains",ref:"text",field:"text"},null,512),s(n,{header:"Voto",field:"rating"},{body:c(({data:e})=>[s(r,{modelValue:e.rating,"onUpdate:modelValue":l=>e.rating=l,readonly:"",cancel:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(n,{header:"",filterMatchMode:"contains",ref:"approved",field:"approved",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{header:c(()=>[G]),filter:c(({filterModel:e,filterCallback:l})=>[s(F,{modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,options:o.status,optionLabel:"name",optionValue:"value",onChange:i=>l(),placeholder:"Filtra per stato"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:c(({data:e})=>[u("div",J,[e.approved?(b(),y("i",Q)):(b(),y("i",H))])]),_:1},512),s(n,{header:"",style:{width:"4rem"}},{body:c(({data:e})=>[u("div",W,[T(s(M,{type:"button",onClick:l=>o.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-2",icon:"pi pi-thumbs-up",text:"",rounded:""},null,8,["onClick"]),[[S,"Approva",void 0,{top:!0}]]),T(s(M,{type:"button",onClick:l=>o.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-thumbs-down",text:"",rounded:""},null,8,["onClick"]),[[S,"Rifiuta",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const Y=K(L,[["render",X]]),Z={setup(){const p=D(),a=k(()=>p.getTotalReviews),m=U();return{totalReviews:a,showSidebar:function(){m.setDetailType("review",!0,"Nuova recensione",null),m.updateSidebar(!0),m.setShowDetail(!0)}}},components:{ReviewsTable:Y}},ee={class:"flex justify-content-between align-items-center"},te={class:""},oe={key:0},le={key:1};function ae(p,a,m,o,V,R){const h=d("ReviewsTable");return b(),y("div",null,[u("div",ee,[u("h1",te,[o.totalReviews==1?(b(),y("span",oe," 1 Recensione")):(b(),y("span",le,g(o.totalReviews)+" Recensioni",1))])]),s(h)])}const ce=K(Z,[["render",ae]]);export{ce as default};
