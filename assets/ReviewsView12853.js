import{o as k,y as q,L as T,A as D,f as C,a as K,B as f,C as z,g as B,D as N,_ as U,r as _,E as O,h as M,i as F,j as l,w as n,k as y,l as h,G as x,t as b,H as A}from"../index12853.js";const L={setup(){k(()=>{v.value=!0,r.value={first:0,rows:g.value.rows,sortField:null,sortOrder:null,filters:s.value},q.register("myfilter",(o,w)=>o===w),p()});const c=T(),a=D(),u=C(()=>c.status),t=C(()=>c.responseReviews),R=K(),g=f(),m=f(),s=f({global:{value:null,matchMode:"like"},name:{value:"",matchMode:"like"},email:{value:"",matchMode:"eq"},created_at:{value:"",matchMode:"like"},role:{value:"",matchMode:"eq"},location:{value:"",matchMode:"eq"},enabled:{value:"",matchMode:"eq"}}),v=f(!0),r=f(),S=f(0),V=f([{label:"My Filter",value:"myfilter"}]);function p(){var w;v.value=!0;let o=new Map;(w=s.value.global)!=null&&w.value&&o.set("name_like",s.value.global.value),o=z(s,o),o.delete("location_eq"),o.delete("global"),o.set("page",r.value.page+1),o.set("per_page",r.value.rows),r.value.sortField&&(r.value.sortOrder==1?o.set("sorted_by",r.value.sortField+"_asc"):o.set("sorted_by",r.value.sortField+"_desc")),setTimeout(()=>{e(o)},Math.random()*1e3+250)}const e=async function(o){await c.fetchAllReviews(o).then(()=>{v.value=!1}).catch(w=>{v.value=!1,B(R,w)})};return{dt:g,responseReviews:t,filters:s,loading:v,totalRecords:S,lazyParams:r,matchModes:V,currentReview:m,status:u,onPage:o=>{r.value=o,p()},onSort:o=>{r.value=o,p()},onFilter:()=>{r.value.page=0,r.value.filters=s.value,p()},showSidebar:function(o){a.setDetailType("review",!1,"Dettaglio recensione",o.id),a.updateSidebar(!0)},loadLazyData:p,changeStatus:async function(o){},getRowClass:function(o){return o!=null&&o.cluster?o.cluster:""},formatDataFromUnixTimestamps:N}},components:{}};const P={class:"user-table"},E={class:"flex justify-content-between align-items-center"},I={class:"p-input-icon-left w-full mr-3 py-2"},$=y("i",{class:"pi pi-search"},null,-1),j=y("div",{class:"truncate"}," Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. ",-1);function G(c,a,u,t,R,g){const m=_("InputText"),s=_("Column"),v=_("Calendar"),r=_("Dropdown"),S=_("Button"),V=_("DataTable"),p=O("tooltip");return M(),F("div",P,[l(V,{value:t.responseReviews.users,totalRecords:t.responseReviews.total,lazy:!0,paginator:!0,rows:30,filters:t.filters,"onUpdate:filters":a[1]||(a[1]=e=>t.filters=e),ref:"dt",dataKey:"id",loading:t.loading,onPage:a[2]||(a[2]=e=>t.onPage(e)),onSort:a[3]||(a[3]=e=>t.onSort(e)),onFilter:a[4]||(a[4]=e=>t.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:"",rowClass:t.getRowClass},{header:n(()=>[y("div",E,[y("span",I,[$,l(m,{modelValue:t.filters.global.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.filters.global.value=e),placeholder:"Ricerca per email",class:"border-none w-full",onChange:t.loadLazyData},null,8,["modelValue","onChange"])])])]),empty:n(()=>[h(" Nessuna recensione trovata. ")]),default:n(()=>[l(s,{field:"name",header:"Nome Cognome",filterMatchMode:"contains",ref:"name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:d})=>[l(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,onKeydown:x(i=>d(),["enter"]),class:"p-column-filter",placeholder:"Filtra per cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:n(({data:e})=>[h(b(e==null?void 0:e.first_name)+" "+b(e==null?void 0:e.last_name),1)]),_:1},512),l(s,{field:"email",header:"Email",filterMatchMode:"contains",ref:"email",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:d})=>[l(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,onKeydown:x(i=>d(),["enter"]),class:"p-column-filter",placeholder:"Filtra per email"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),body:n(({data:e})=>[h(b((e==null?void 0:e.email)||"-"),1)]),_:1},512),l(s,{header:"Audio itinerario"},{body:n(()=>[h("Quanto Ã¨ bella Torino")]),_:1}),l(s,{header:"Descrizione",filterMatchMode:"contains",ref:"location",field:"location"},{body:n(({data:e})=>[j]),_:1},512),l(s,{header:"Voto"},{body:n(()=>[h("5")]),_:1}),l(s,{header:"Data creazione",field:"created_at",filterMatchMode:"contains",ref:"created_at",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:d})=>[l(v,{inputId:"dateformat",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,dateFormat:"dd/mm/yy",onKeydown:x(i=>d(),["enter"]),manualInput:!1,placeholder:"Filtra per data",onDateSelect:i=>d()},null,8,["modelValue","onUpdate:modelValue","onKeydown","onDateSelect"])]),body:n(({data:e})=>[h(b(t.formatDataFromUnixTimestamps(e==null?void 0:e.created_at)),1)]),_:1},512),l(s,{header:"Stato",filterMatchMode:"contains",ref:"enabled",field:"enabled",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:n(({filterModel:e,filterCallback:d})=>[l(r,{modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,options:t.status,optionLabel:"name",optionValue:"value",onChange:i=>d(),placeholder:"Filtra per stato"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:n(({data:e})=>[h(b(e.enabled?"Attivo":"Disattivo"),1)]),_:1},512),l(s,{header:"",style:{width:"4rem"}},{body:n(({data:e})=>[A(l(S,{type:"button",onClick:d=>t.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[p,"Modifica",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading","rowClass"])])}const H=U(L,[["render",G]]),Q={setup(){const c=T(),a=C(()=>c.getTotalReviews),u=D();return{totalReviews:a,showSidebar:function(){u.setDetailType("review",!0,"Nuova recensione",null),u.updateSidebar(!0),u.setShowDetail(!0)}}},components:{ReviewsTable:H}},J={class:"flex justify-content-between align-items-center"},W={class:""},X={key:0},Y={key:1};function Z(c,a,u,t,R,g){const m=_("ReviewsTable");return M(),F("div",null,[y("div",J,[y("h1",W,[t.totalReviews==1?(M(),F("span",X," 1 Recensione")):(M(),F("span",Y,b(t.totalReviews)+" Recensioni",1))])]),l(m)])}const se=U(Q,[["render",Z]]);export{se as default};
